

<table class="table table-striped table-hover" id="statstable" _="install Sortable">
    <thead>
        <tr>
        <th scope="col">Meta rank</th>
        <th scope="col">Deck Name</th>
        <th scope="col">Meta Share*</th>
        <th scope="col">My Win % </th>
        <th>Played</th>
        <th>Wins</th>
        <th>Losses</th>  
        </tr>
    </thead>
    <tbody id="tablebodyplace">
            {% if checkfilter == True and deck.mynumgames != 0 %}
            {% for deck in mytopdeckslegacy %}
                {% if deck.mynumgames != 0 %}
                    <tr>
                        <th scope="row">{{ forloop.counter }}</th>
                        <td>{{ deck.theirDeck__name }}</td>
                        {% if deck.percentpopularity > 9 %}
                            <td>{{ deck.percentpopularity }}% <span>&#8226;</span> <small>{{ deck.popularity }} decks </small></td>
                        {% else %}
                            <td>&nbsp;{{ deck.percentpopularity }}% <span>&#8226;</span> <small>{{ deck.popularity }} deck{% if deck.popularity > 1 %}s{% endif %} </small></td>
                        {% endif %}
                        <td>{{ deck.mwp }}% &nbsp;&nbsp; </td>

                        <td>
                            {{ deck.mynumgames }}
                        </td>
                        <td>
                            {{deck.mywingames}}
                        </td>
                        <td>
                            {{deck.mylossgames}}
                        </td>
                    </tr>
                {% endif %}
            {% endfor %}
            {% else %}
            {% for deck in mytopdeckslegacy %}
            <tr>
                <th scope="row">{{ forloop.counter }}</th>
                <td>{{ deck.theirDeck__name }}</td>
                {% if deck.percentpopularity > 9 %}
                    <td>{{ deck.percentpopularity }}% <span>&#8226;</span> <small>{{ deck.popularity }} decks </small></td>
                {% else %}
                    <td>&nbsp;{{ deck.percentpopularity }}% <span>&#8226;</span> <small>{{ deck.popularity }} deck{% if deck.popularity > 1 %}s{% endif %} </small></td>
                {% endif %}
                {% if deck.mynumgames == 0 %}
                    <td>--</td>
                {% else %}
                    <td>{{ deck.mwp }}% &nbsp;&nbsp; </td>
                {% endif %}

                <td>
                    {{ deck.mynumgames }}
                </td>
                <td>
                    {{deck.mywingames}}
                </td>

                <td>
                    {{deck.mylossgames}}
                </td>
            </tr>
            {% endfor %}
            {% endif %}

            <tfoot>
                <tr>
                    <td></td>
                    <td></td>
                    <td>&nbsp;<small>total: {{ num_decks }} decks</small></td>
                </tr>
            </tfoot>
        </tbody>
</table>
<script type="text/hyperscript">
    behavior Sortable
      on click from <th/>
        -- get all the headers and the index of the column
        set headers to <th/> in me
        set col to headers.indexOf(target)
        
        -- get the table body and the rows as an array
        set tbody to the first <tbody/> in me
        set rowArray to (<tr/> in tbody) as Array
  
        -- if this is a first click on this header
        -- clear the data-ascending attribute on any other header
        if target @data-ascending is null
          remove @data-ascending from headers
          log "test1 sucess"
        end
        
        -- sort the array depending on the ascending header
        if target @data-ascending is 'true'
          set target @data-ascending to 'false'
          if the target's @data-numeric is "true"
            rowArray.sort(\ row1, row2 -> row1.children[col].innerText as Int <
                                          row2.children[col].innerText as Int )
                                          log "test2 data-numeric"
          otherwise              
            rowArray.sort(\ row1, row2 -> row1.children[col].innerText <
                                          row2.children[col].innerText )
                                          log "test3 NOT data-numeric"
          end
        else
          set target @data-ascending to 'true'
          if the target's @data-numeric is "true"
            rowArray.sort(\ row1, row2 -> row1.children[col].innerText as Int >
                                          row2.children[col].innerText as Int )
                                          log "test4 data-numeric"
          otherwise              
            rowArray.sort(\ row1, row2 -> row1.children[col].innerText >
                                          row2.children[col].innerText )
                                          log "test5 NOT data-numeric"
  
          end
        end
        
        -- merge back into the tbody
        for row in rowArray
          tbody.append(row)
        end
      end  
    end
</script>
{% if num_decks > 100 %}
    <div>hello</div>
    <!-- <script>
        $(document).ready( function () {
        $('#statstable').DataTable();
        } );
    </script> -->
{% endif %}
